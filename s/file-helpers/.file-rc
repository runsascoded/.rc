
export fh="$(dirname "${BASH_SOURCE[0]}")"

defn canonicalize realpath -s
defn cz canonicalize
defn czl realpath

defn ul readlink
defn ulm readlink -m
defn ule readlink -e

# namei for OSX: brew install mkdryden/homebrew-misc/namei
defn ni namei

if [ ! -e "$fh/readlink" ]; then
  if which greadlink &> /dev/null; then
    cmd="greadlink"
  elif which readlink &> /dev/null; then
    cmd="readlink"
  else
    echo "Warning: no readlink or greadlink found" 1>&2
  fi

  if [ -n "$cmd" ]; then
    full_cmd="$(which "$cmd")"
    ln -sf "$full_cmd" "$fh/readlink"
  fi
fi

if which-exists ghead; then
  export ghead=ghead
else
  export ghead=head
fi

if which-exists gtail; then
  export gtail=gtail
else
  export gtail=tail
fi

defn sl slice-lines

defn dll drop-last-lines
defn kll drop-last-lines

defn dn multi-dirname
ldn() {
  l "$(dn "$@")"
}
cdn() {
  cd "$(dn "$@")"
}

defn dush dus -h
defn dsh dus -h
defn db du -b
defn dub du -b

defn ts total-size -h
defn tsr total-size

defn enl every-nth-line
defn e4l every-nth-line 4

defn n wc -l
defn N wc -l
defn wcl wc -l
defn wl wc -l
defn n1 count-lines
defn wcc wc -c

defn lsgl ls-grep-link-dest

defn chmd make-executable
defn me make-executable
defn cmd make-executable

defn ordx ord -x
defn ox ord -x

defn cr chr
defn cx chr -x

defn tk take
defn tkr take-right

defn dls drop-lines
defn d1l tail -n +2
defn dl1 tail -n +2
defn dl2 tail -n +3
defn d1 tail -n +2
defn d2 tail -n +3

defn tls take-lines
defn tkl take-lines
defn t1l head -n 1
defn t1l head -n 1

defn clr clear-file
defn cl clear-file

defn pdn pwd-dirname
defn pbn pwd-basename

defn sbd sort-by-date
defn dp dir-perms
defn dtr dir-tree
defn drt dir-tree

defn es excise-substring
defn ks excise-substring
defn rms excise-substring

defn tt take-to
defn ttf take-to
defn tu take-until
defn tuf take-until
defn dpf take-to
defn dff take-until

defn last_modified_time stat -c %Y
defn lmt stat -c %Y

defn ub unbak

defn exists apply-test -e
defn dne apply-test '!' -e
