#!/usr/bin/env bash

# Maven aliases and env vars

#export nt="-Dmaven.test.skip -DskipTests"
export nt="-DskipTests"

alias mvp="mvn package $nt"
alias mvnp="mvn package $nt"
alias mvncp="mvn clean package $nt"

alias mvnc="mvn compile"
alias mc="mvn compile"

alias mcl="mvn clean"

alias mvncc="mvn clean compile"
alias mvnct="mvn clean test"

alias mvndt="mvn dependency:tree"
alias mvdt="mvn dependency:tree"
alias mdt="mvn dependency:tree"
alias mdtl="mvn dependency:tree | less"
alias mdtv="mvn dependency:tree -Dverbose"
alias mdtvl="mvn dependency:tree -Dverbose | less"

alias mvnsc="mvn scala:cc"

alias mvntc="mvn test-compile"
alias mtc="mvn test-compile"

alias mvnt=mvn-test
alias mt=mvn-test

alias mi="mvn install $nt"
alias mvi="mvn install $nt"
alias mvni="mvn install $nt"
alias mvnil="mvn install $nt -Plocal"
alias mvnl=maven-install-local-sha
alias mvnci="mvn clean install $nt"

alias mvs=maven-version-set

export m2="$HOME/.m2/repository"
export M="$m2"

if [ -z "$JAVA_HOME" -a -d "$HOME"/java8 ]; then
  export JAVA_HOME="$HOME"/java8
fi

if [ -d "$HOME"/apache-maven-3.3.3 ]; then
  export MAVEN_HOME="$HOME"/apache-maven-3.3.3
fi

if [ -d "$HOME"/apache-maven-3.3.3 ]; then
  export M2_HOME="$HOME"/apache-maven-3.3.3
fi

get-maven-opt() {
  opt="$(echo "$MAVEN_OPTS" | perl -pe "s/.*-X${1}([^ ]+).*/\1/")"
  opt="${opt:--}"
  echo "$opt"
}

set-maven-opts() {
  xmx="$(get-maven-opt "mx")"
  echo "Xmx: $xmx"
}
